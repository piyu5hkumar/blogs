{% extends 'base/layout.html' %}

{% block content %}
<div class="container mt-5" style="margin-top: 50px; width: 30%; padding-bottom: 100px;">
        <h1 id="form-title" class="text-center">Sign In</h1>
        <form id="auth-form">
                <!-- Login Form -->
                <div id="login-form" class="form-content">
                        <div data-mdb-input-init class="form-outline mb-4">
                                <input type="email" id="login-email" class="form-control" />
                                <label class="form-label" for="login-email">Email address</label>
                        </div>

                        <div data-mdb-input-init class="form-outline mb-4">
                                <input type="password" id="login-password" class="form-control" />
                                <label class="form-label" for="login-password">Password</label>
                        </div>

                        <div class="d-flex justify-content-center">
                                <button type="button" class="btn btn-primary">Sign in</button>
                        </div>

                        <div class="row mb-4 mt-4">
                                <a class="text-center" href="#!">Forgot password?</a>
                        </div>

                        <p class="text-center">Not a member? <a href="#" id="toggle-to-register">Register</a></p>
                </div>

                <!-- Registration Form -->
                <div id="register-form" class="form-content"
                        style="opacity: 0; visibility: hidden; position: absolute; top: 0;">
                        <div data-mdb-input-init class="form-outline mb-4">
                                <input type="text" id="register-name" class="form-control" />
                                <label class="form-label" for="register-name">Name</label>
                        </div>

                        <div data-mdb-input-init class="form-outline mb-4">
                                <input type="email" id="register-email" class="form-control" />
                                <label class="form-label" for="register-email">Email address</label>
                        </div>

                        <div data-mdb-input-init class="form-outline mb-4">
                                <input type="password" id="register-password" class="form-control" />
                                <label class="form-label" for="register-password">Password</label>
                        </div>

                        <div class="d-flex justify-content-center">
                                <button type="button" id="register-button" class="btn btn-primary">Register</button>
                        </div>

                        <p class="text-center mt-4">Already a member? <a href="#" id="toggle-to-login">Login</a></p>
                </div>
        </form>
</div>

<style>
        .form-content {
                transition: opacity 0.5s ease, visibility 0.5s ease-in-out;
        }
</style>

<script>
        document.getElementById('toggle-to-register').addEventListener('click', function (event) {
                event.preventDefault();
                document.getElementById('login-form').style.opacity = '0';
                document.getElementById('login-form').style.visibility = 'hidden';
                setTimeout(function () {
                        document.getElementById('login-form').style.position = 'absolute';
                        document.getElementById('register-form').style.position = 'relative';
                        document.getElementById('register-form').style.opacity = '1';
                        document.getElementById('register-form').style.visibility = 'visible';
                        document.getElementById('form-title').textContent = 'Register';
                }, 500); // match the transition duration
        });

        document.getElementById('toggle-to-login').addEventListener('click', function (event) {
                event.preventDefault();
                document.getElementById('register-form').style.opacity = '0';
                document.getElementById('register-form').style.visibility = 'hidden';
                setTimeout(function () {
                        document.getElementById('register-form').style.position = 'absolute';
                        document.getElementById('login-form').style.position = 'relative';
                        document.getElementById('login-form').style.opacity = '1';
                        document.getElementById('login-form').style.visibility = 'visible';
                        document.getElementById('form-title').textContent = 'Login';
                }, 500); // match the transition duration
        });


        document.getElementById('register-button').addEventListener('click', function () {
                // Get the values from the form fields
                const name = document.getElementById('register-name').value;
                const email = document.getElementById('register-email').value;
                const password = document.getElementById('register-password').value;

                // Make the Axios POST request
                axios.post('http://127.0.0.1:8000/api/v1/users/register/', {
                        name: name,
                        email: email,
                        password: password
                }, {
                        headers: {
                                'Content-Type': 'application/json'
                        }
                })
                .then(response => {
                        // Handle the response data
                        console.log(response.data);
                        alert('Registration successful!');
                })
                .catch(error => {
                        if (error.response) {
                                appendAlert(`[${error.response.status}]: ${error.response.data.message}`, 'danger')
                        } else {
                                showAlert('Registration failed: ' + error.message, 'danger');
                        }

                });
        });
</script>
{% endblock %}